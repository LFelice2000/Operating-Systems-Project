Dos programas:

MINERO

- cada minero tiene dos procesos: proceso Padre y proceso Registrador
- proceos Minero crea los hilos que buscan la solución de POW
- el proceos Registrador, almacena las soluciones en un fichero
- los mineros se lanzan en diferentes terminales
- el primer minero, prepara la estructura de datos para almacenar las soluciones
- si un minero entra en el sistema, habrá que registrarle en la estructura de datos
- si un minero sale del sistema, habrá que eliminarlo de la estructura de datos

MONITOR
- el monitor tendrá dos procesos: proceso Comprobador y proceso Monitor
- el Monitor puede arrancar en cualquier momento
- el Monitor se encarga de mostrar por pantalla como va la búsqueda de soluciones
- el Monitor puede cerrarse en cualquier momento y si se abre de nuevo, se mostrará el estado actual de la búsqueda de soluciones


BLOQUE
- contiene el id del Bloque (incremental)
- target: objetivo
- solución del objetivo
- PID del minero ganador
- carteras de los mineros que han participado en la búsqueda de la solución
 (cuando un mineor llega a la solución, se envía la solución a todos los demás mineros, se vota; si la votación es positiva, el minero
ganador, gana una moneda y se inserta en su cartera)
- el número de votos totales para evaluar la solución

SEGMENTO DE MEMORIA COMPARTIDA
- listado de PIDS de los mineros activos
- listado de votos de cada minero
- listado con las monedas obtenidas por cada minero
- último bloque resuelto y bloque actual que se está resolviendo

PROCESO MINERO:
- dos variables: segundos de ejecución y número de hilos
- el Registrador, registra lso bloques en un fichero
- primer minero crea o abre la memoria compartida y la estructura de datos
- MAXIMO 100 mineros

MINADO
- solo puede haber un GANADOR (sem parecido al del Candidato)

VOTACIÓN
- 100 intentos para verficar que todos los procesos han votado
(lo que garantiza que el sistema
no se bloquee si termina de forma abrupta alg ́un minero antes de votar)

ENVÍO BLOQUE
- proceso Ganador solo se envía si hay un monitor esperando (semaforo con nombre)


proceso comprobador puede recibir SIGINT, entonces tiene que mandar el bloque finalizacion
al proceso monitor



/*** DUDAS ***/

- por qué el sistema tiene que guardar el listado de monedas de cada minero?
- qué hace Registrador? todos los mineros, le envían su propio bloque (sea correcto o no) o le envían el bloque ganador o sólo el minero ganador?
- cuando un hilo encuentra la solución, los demás hilos acaban y además los hilos de los demás mineros también acaban?
- qué les hace salir del minado a los otro mineros? SIGUSR2? pero luego, vuelven a esperar a SIGUSR2 para votar, entonces?


- cada minero envía el bloque ganador a su padre Registrador
- el registrador luego lo escribe en un fichero
- para votar, hace rpow_hash otra vez
- el sistema guarda el array de carteras
- dos SIGUSR2

/*** RESUELTO ***/


NUEVA DUDA:
- Hace esperas no activas cortas hasta que todos los procesos introduzcan su voto, o
hasta que transcurra un n ́umero m ́aximo de intentos (lo que garantiza que el sistema
no se bloquee si termina de forma abrupta alg ́un minero antes de votar).

se hacen las dos o sólo una de las 2? 


- se hacen las 2



/***** NUEVO *****/
- Una vez se ha lanzado el primer minero, cualquier otro minero lanzado se une a la red de
mineros.





MÁS COSAS::::::::::::::::::
- (HECHO) falta sigint a monitor
- falta check SIGUSR2 (main problema)
- el propio winner se vota?
- probar un propio bloque para enviar

